import{_ as s,o as a,c as e,a as n}from"./app.45e7eacb.js";const m=JSON.parse('{"title":"Podman","description":"","frontmatter":{"outline":"deep"},"headers":[{"level":2,"title":"command","slug":"command","link":"#command","children":[{"level":3,"title":"run","slug":"run","link":"#run","children":[]}]},{"level":2,"title":"Podman for Debian\uFF08WSL2\uFF09","slug":"podman-for-debian-wsl2","link":"#podman-for-debian-wsl2","children":[{"level":3,"title":"podman","slug":"podman-1","link":"#podman-1","children":[]},{"level":3,"title":"mysql","slug":"mysql","link":"#mysql","children":[]},{"level":3,"title":"redis & redisinsight","slug":"redis-redisinsight","link":"#redis-redisinsight","children":[]}]},{"level":2,"title":"Podman for Windows\uFF08WSL2\uFF09","slug":"podman-for-windows-wsl2","link":"#podman-for-windows-wsl2","children":[{"level":3,"title":"mysql","slug":"mysql-1","link":"#mysql-1","children":[]},{"level":3,"title":"redis","slug":"redis","link":"#redis","children":[]},{"level":3,"title":"redis & redisinsight","slug":"redis-redisinsight-1","link":"#redis-redisinsight-1","children":[]}]},{"level":2,"title":"\u5207\u6362\u81F3\u56FD\u5185\u955C\u50CF","slug":"\u5207\u6362\u81F3\u56FD\u5185\u955C\u50CF","link":"#\u5207\u6362\u81F3\u56FD\u5185\u955C\u50CF","children":[]},{"level":2,"title":"ssh","slug":"ssh","link":"#ssh","children":[]},{"level":2,"title":"Rootfull & Rootless","slug":"rootfull-rootless","link":"#rootfull-rootless","children":[{"level":3,"title":"root","slug":"root","link":"#root","children":[]},{"level":3,"title":"rootless","slug":"rootless","link":"#rootless","children":[]}]},{"level":2,"title":"cockpit","slug":"cockpit","link":"#cockpit","children":[{"level":3,"title":"\u5B89\u88C5","slug":"\u5B89\u88C5","link":"#\u5B89\u88C5","children":[]},{"level":3,"title":"\u542F\u52A8","slug":"\u542F\u52A8","link":"#\u542F\u52A8","children":[]}]},{"level":2,"title":"WSL2\u73B0\u5DF2\u652F\u6301Systemd-2022.9.27","slug":"wsl2\u73B0\u5DF2\u652F\u6301systemd-2022-9-27","link":"#wsl2\u73B0\u5DF2\u652F\u6301systemd-2022-9-27","children":[]},{"level":2,"title":"\u89E3\u51B3WSL2\u4E0D\u652F\u6301Systemd\u{1F6AB}","slug":"\u89E3\u51B3wsl2\u4E0D\u652F\u6301systemd\u{1F6AB}","link":"#\u89E3\u51B3wsl2\u4E0D\u652F\u6301systemd\u{1F6AB}","children":[{"level":3,"title":"Enable distrod in your distro","slug":"enable-distrod-in-your-distro","link":"#enable-distrod-in-your-distro","children":[]},{"level":3,"title":"Disable Systemd Distrod","slug":"disable-systemd-distrod","link":"#disable-systemd-distrod","children":[]},{"level":3,"title":"Uninstall distrod","slug":"uninstall-distrod","link":"#uninstall-distrod","children":[]},{"level":3,"title":"Restart your distro","slug":"restart-your-distro","link":"#restart-your-distro","children":[]},{"level":3,"title":"\u65B0\u5F00wsl bash\u6267\u884C","slug":"\u65B0\u5F00wsl-bash\u6267\u884C","link":"#\u65B0\u5F00wsl-bash\u6267\u884C","children":[]}]},{"level":2,"title":"cockpit Extendable","slug":"cockpit-extendable","link":"#cockpit-extendable","children":[{"level":3,"title":"Podman container support","slug":"podman-container-support","link":"#podman-container-support","children":[]}]}],"relativePath":"backend/container/podman.md","lastUpdated":1668526688000}'),o={name:"backend/container/podman.md"},l=n(`<h1 id="podman" tabindex="-1">Podman <a class="header-anchor" href="#podman" aria-hidden="true">#</a></h1><p><a href="https://podman.io/" target="_blank" rel="noreferrer">https://podman.io/</a></p><blockquote><p>Emulate Docker CLI using podman. Create /etc/containers/nodocker to quiet msg.</p></blockquote><h2 id="command" tabindex="-1">command <a class="header-anchor" href="#command" aria-hidden="true">#</a></h2><h3 id="run" tabindex="-1">run <a class="header-anchor" href="#run" aria-hidden="true">#</a></h3><p><a href="https://www.runoob.com/docker/docker-run-command.html" target="_blank" rel="noreferrer">https://www.runoob.com/docker/docker-run-command.html</a></p><h2 id="podman-for-debian-wsl2" tabindex="-1">Podman for Debian\uFF08WSL2\uFF09 <a class="header-anchor" href="#podman-for-debian-wsl2" aria-hidden="true">#</a></h2><p>Ubuntu\u57FA\u4E8EDebian\uFF0C\u90FD\u53EF\u4F7F\u7528<code>apt-get</code></p><p><a href="https://podman.io/getting-started/installation#:~:text=the%20available%20streams.-,Ubuntu,-The%20podman%20package" target="_blank" rel="noreferrer">Podman for Ubuntu</a></p><h3 id="podman-1" tabindex="-1">podman <a class="header-anchor" href="#podman-1" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># Ubuntu 20.10 and newer</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo apt-get -y update</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo apt-get -y install podman</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo apt -y update</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo apt -y install podman</span></span>
<span class="line"></span></code></pre></div><h3 id="mysql" tabindex="-1">mysql <a class="header-anchor" href="#mysql" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman run --name mysql -p 3306:3306 -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=root -d mysql:latest</span></span>
<span class="line"></span></code></pre></div><p><code>podman logs mysql</code> \u67E5\u770B\u62A5\u9519\uFF1A<strong style="color:red;">chown: changing ownership of &#39;/var/lib/mysql/&#39;: Operation not permitted</strong>\uFF0C\u8BE5\u62A5\u9519\u7684\u672C\u8D28\u539F\u56E0\u53EF\u53C2\u8003</p><p><a href="https://github.com/docker-library/mysql/issues/396%EF%BC%8C" target="_blank" rel="noreferrer">https://github.com/docker-library/mysql/issues/396\uFF0C</a></p><blockquote><p>Since there is not a supervisor or init system running in the container, things like <code>service mysql start</code> will not do what you expect. There is a bunch of setup that is done by the <a href="https://github.com/docker-library/mysql/blob/30bf2b7ff3010d1f2ee89967dd1303d6a7230c51/5.7/docker-entrypoint.sh" target="_blank" rel="noreferrer"><code>docker-entrypoint.sh</code></a> script that is not done when you start the container with the <code>bash</code> process. There is also the problem of <code>bash</code> being pid 1, so once it exits, that container exits and all child processes \u2014 like those spawned by an init script \u2014 are killed.</p><p>As for the <code>chown</code> failing that is often caused by Docker for Mac/Windows (or Boot2Docker/Docker Toolbox) folder sharing from the Docker virtual machine to the Host OS. The workaround is to just run the container as the owner of the directory you are trying to use:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ docker run -d -e MYSQL_ROOT_PASSWORD=admin -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/mysql/data:/var/lib/mysql --user 1000:50 mysql:latest</span></span>
<span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#676E95;"># or whatever user and group id that the container sees on the mounted folder:</span></span>
<span class="line"><span style="color:#A6ACCD;">$ docker run -it --rm -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/mysql/data:/var/lib/mysql mysql:latest ls -aln /var/lib/mysql</span></span>
<span class="line"></span></code></pre></div></blockquote><p>\u6211\u8FD9\u91CC\u4F7F\u7528<a href="https://www.cnblogs.com/kongzhongqijing/p/3488884.html#:~:text=%E4%BA%8C%E3%80%81-,ll%E5%91%BD%E4%BB%A4%E7%BB%93%E6%9E%9C%E8%AF%B4%E6%98%8E,-drwxr%2Dxr%2Dx" target="_blank" rel="noreferrer"><code>ll</code></a> \u547D\u4EE4\u67E5\u770B\u5230<code>~/mypod/mysql/data</code>\u6587\u4EF6\u5939\u7531<code>root</code>\u7528\u6237\u521B\u5EFA\uFF0C\u6539\u6210<code>\u975E\u6839\u7528\u6237</code>\u521B\u5EFA\u4E4B\u540E\uFF0C\u7ED9\u4E88\u6743\u9650<strong style="color:#42e4ff;">\u53EF\u8BFB\u53EF\u5199\u53EF\u6267\u884C\uFF08\u5371\u9669\uFF09</strong><code>chmod 777 ~/mypod/mysql/data</code>\u4E4B\u540E\u89E3\u51B3\uFF0C\u8FD9\u4E0D\u662F\u6700\u4F73\u529E\u6CD5\uFF0C<code>chmod 777</code>\u662F\u4E00\u4E2A\u5371\u9669\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u7528\u4E0A\u9762\u7684\u65B9\u6CD5</p><p>\u81F3\u4E8E3306\u7AEF\u53E3\u5360\u7528\uFF0Cpowershell\u6267\u884C\uFF1A<code>netstat -aon|findstr &quot;3306&quot;</code>\uFF0C\u7ED3\u675F\u5BF9\u5E94PID\u8FDB\u7A0B\u5373\u53EF</p><h3 id="redis-redisinsight" tabindex="-1">redis &amp; redisinsight <a class="header-anchor" href="#redis-redisinsight" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman run -d --name redis-stack -p 127.0.0.1:6379:6379 -p 8001:8001 -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/redis/conf/local-redis-stack.conf:/redis-stack.conf -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/redis/data:/data -e REDIS_ARGS=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--requirepass 12345</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> -e REDIS_ARGS=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--appendonly yes</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> redis/redis-stack:latest</span></span>
<span class="line"></span></code></pre></div><h2 id="podman-for-windows-wsl2" tabindex="-1">Podman for Windows\uFF08WSL2\uFF09 <a class="header-anchor" href="#podman-for-windows-wsl2" aria-hidden="true">#</a></h2><p><a href="https://github.com/containers/podman/blob/main/docs/tutorials/podman-for-windows.md" target="_blank" rel="noreferrer">podman/podman-for-windows.md at main \xB7 containers/podman \xB7 GitHub</a></p><p>\u7B80\u800C\u8A00\u4E4B\uFF0C\u5BB9\u5668\u662F\u9488\u5BF9Linux\u800C\u8A00\u7684\uFF0C\u5BF9\u4E8Ewindows\u5219\u662F\u57FA\u4E8EWSL2</p><ol><li><p>\u5148\u4E0B\u8F7D\u5B89\u88C5 <strong style="color:#42e4ff;">podman-v.#.#.#.msi</strong>\uFF0C<a href="https://github.com/containers/podman/releases" target="_blank" rel="noreferrer">Releases \xB7 containers/podman \xB7 GitHub</a></p></li><li><div class="language-powershell"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman machine init</span></span>
<span class="line"><span style="color:#A6ACCD;">podman machine start</span></span>
<span class="line"></span></code></pre></div></li></ol><h3 id="mysql-1" tabindex="-1">mysql <a class="header-anchor" href="#mysql-1" aria-hidden="true">#</a></h3><p><a href="https://hub.docker.com/_/mysql" target="_blank" rel="noreferrer">mysql - Official Image | Docker Hub</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman pull mysql:latest</span></span>
<span class="line"></span></code></pre></div><p>\u5C06\u9ED8\u8BA4 mysql \u6570\u636E\u76EE\u5F55\u6302\u8F7D\u5230 host system</p><ul><li><a href="https://hub.docker.com/_/mysql#:~:text=Caveats-,Where%20to%20Store%20Data,-Important%20note%3A%20There" target="_blank" rel="noreferrer">Where to Store Data</a></li><li><a href="https://github.com/containers/podman/blob/main/docs/tutorials/podman-for-windows.md#volume-mounting" target="_blank" rel="noreferrer">volume-mounting</a></li><li><code>-p HostPort:ContainerPort</code></li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman run -d --name mysql -p 3306:3306 -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=root mysql:latest</span></span>
<span class="line"></span></code></pre></div><h3 id="redis" tabindex="-1">redis <a class="header-anchor" href="#redis" aria-hidden="true">#</a></h3><p><a href="https://hub.docker.com/_/redis" target="_blank" rel="noreferrer">redis - Docker Image | Docker Hub</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman pull redis</span></span>
<span class="line"></span></code></pre></div><p><a href="https://cloud.tencent.com/developer/article/1670205" target="_blank" rel="noreferrer">\u6700\u8BE6\u7EC6\u7684docker\u4E2D\u5B89\u88C5\u5E76\u914D\u7F6Eredis - \u817E\u8BAF\u4E91\u5F00\u53D1\u8005\u793E\u533A-\u817E\u8BAF\u4E91 (tencent.com)</a></p><ul><li><p><code>redis-server /etc/redis/redis.conf</code> \u8FD9\u4E2A\u662F\u5173\u952E\u914D\u7F6E\uFF0C\u8BA9redis\u4E0D\u662F\u65E0\u914D\u7F6E\u542F\u52A8\uFF0C\u800C\u662F\u6309\u7167\u8FD9\u4E2Aredis.conf\u7684\u914D\u7F6E\u542F\u52A8</p></li><li><p><code>\u2013appendonly yes</code> redis\u542F\u52A8\u540E\u6570\u636E\u6301\u4E45\u5316</p></li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman run -d -p 6379:6379 --name redis -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/redis/conf/redis.conf:/etc/redis/redis.conf  -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/redis/data:/data redis-server /etc/redis/redis.conf --appendonly yes redis</span></span>
<span class="line"></span></code></pre></div><h3 id="redis-redisinsight-1" tabindex="-1">redis &amp; redisinsight <a class="header-anchor" href="#redis-redisinsight-1" aria-hidden="true">#</a></h3><p><a href="https://hub.docker.com/r/redis/redis-stack" target="_blank" rel="noreferrer">redis/redis-stack - Docker Image | Docker Hub</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u963F\u91CC\u4E91\u955C\u50CF\u76EE\u524D\u6CA1\u8FD9\u4E2A\u955C\u50CF\uFF0C\u6307\u5B9A\u5B8C\u6574\u955C\u50CF\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">podman pull docker.io/redis/redis-stack</span></span>
<span class="line"><span style="color:#676E95;"># \u6216\u8005pull\u7684\u65F6\u5019\u9009\u62E9docker.io\u955C\u50CF\u6E90</span></span>
<span class="line"><span style="color:#A6ACCD;">podman pull redis/redis-stack</span></span>
<span class="line"></span></code></pre></div><ul><li><code>-d</code>\uFF1A\u540E\u53F0\u8FD0\u884C\u5BB9\u5668\uFF0C\u5E76\u8FD4\u56DE\u5BB9\u5668ID\uFF0C\u5426\u5219\u5173\u6389shell\u5BB9\u5668\u5C31\u505C\u4E86\uFF1B<code>--name redis-stack</code>\u548C\u6700\u540E\u7684<code>redis/redis-stack:latest</code>\u53EF\u4EE5\u7406\u89E3\u4E3A\u5BF9\u8C61\u548C\u7C7B\u7684\u5173\u7CFB\uFF0C\u7C7B\u53EF\u4EE5\u521B\u5EFA\u65E0\u6570\u4E2A\u5BF9\u8C61 \u2014\u2014\u2014\u2014 \u4F7F\u7528\u955C\u50CF<code>redis/redis-stack:latest</code>\u4EE5\u540E\u53F0\u6A21\u5F0F\u542F\u52A8\u4E00\u4E2A\u5BB9\u5668,\u5E76\u5C06\u5BB9\u5668\u547D\u540D\u4E3A<code>redis-stack</code></li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">podman run -d --name redis-stack -p 6379:6379 -p 8001:8001 -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/redis/conf/local-redis-stack.conf:/redis-stack.conf -v </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/mypod/redis/data:/data -e REDIS_ARGS=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--requirepass 12345</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> -e REDIS_ARGS=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--appendonly yes</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> redis/redis-stack:latest</span></span>
<span class="line"></span></code></pre></div><p>\u{1F494} <strong style="color:red;">Unable to connect to Redis server: localhost/127.0.0.1:6379</strong></p><p>\u2764\uFE0F it works , \u4F3C\u4E4E\u662Fip\u7684\u95EE\u9898\uFF0C\u4F46\u662F podman mysql \u5C31\u53EF\u4EE5\u6B63\u5E38\u8FDE\u63A5\u3002\u89E3\u51B3\u529E\u6CD5\u76EE\u524D\u662F\u5728WSL2\u4E0B\u67E5\u5230WSL2\u672C\u8EAB\u5BF9\u5E94\u7684ip\uFF0C<code>curl ip:6379</code> \u53EF\u6B63\u5E38\u8FDE\u63A5\uFF0C\u4F46\u8FD9\u4E0D\u5E94\u8BE5\u662F\u4E00\u4E2A\u79D1\u5B66\u7684\u529E\u6CD5\uFF0C\u56E0\u4E3Aip\u4F1A\u53D8</p><blockquote><p><a href="https://github.com/microsoft/WSL/issues/5728#issuecomment-674883029" target="_blank" rel="noreferrer">https://github.com/microsoft/WSL/issues/5728#issuecomment-674883029</a></p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ifconfig</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ip addr show eth0 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> grep </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">inet\\b</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> awk </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{print $2}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> cut -d/ -f1</span></span>
<span class="line"></span></code></pre></div><p>\u{1F494} \u4E0B\u9762\u7684\u5E76\u6CA1\u6709\u4F5C\u7528</p><p><a href="https://stackoverflow.com/questions/70591730/redis-with-wsl2-podman-connection-refused" target="_blank" rel="noreferrer">redis-with-wsl2-podman-connection-refused</a></p><p>\u987A\u4FBF\u770B\u770B\u8FD9\u4E2A\uFF1A <a href="https://docs.microsoft.com/en-us/windows/wsl/networking" target="_blank" rel="noreferrer">Accessing network applications with WSL | Microsoft Docs</a></p><blockquote><p><a href="https://github.com/microsoft/WSL/issues/4851" target="_blank" rel="noreferrer">You probably run into this WSL2 issue</a>\uFF1A</p><p>Solution:</p><ul><li>option 1: use <code>[::1]:6379</code> instead of <code>localhost:6379</code> from Windows side</li><li>option 2: use <code>-p 127.0.0.1:6379:6379</code> instead of <code>-p 6379:6379</code> with <code>podman run</code>.</li></ul></blockquote><h2 id="\u5207\u6362\u81F3\u56FD\u5185\u955C\u50CF" tabindex="-1">\u5207\u6362\u81F3\u56FD\u5185\u955C\u50CF <a class="header-anchor" href="#\u5207\u6362\u81F3\u56FD\u5185\u955C\u50CF" aria-hidden="true">#</a></h2><p>\u{1F389} <a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noreferrer">\u963F\u91CC\u4E91\u955C\u50CF</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u7F16\u8F91\u9700\u8981root\u6743\u9650</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo vi /etc/containers/registries.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u53EA\u9700\u8981\u5728unqualified-search-registries\u6DFB\u52A0\u963F\u91CC\u955C\u50CF\u5C31\u53EF\u4EE5\uFF0C\u6B63\u5E38\u60C5\u51B5pull\u7684\u65F6\u5019\u4F1A\u8BA9\u4F60\u9009\u62E9\u955C\u50CF\u6E90\uFF0Custc\u4E2D\u56FD\u79D1\u5B66\u6280\u672F\u5927\u5B66</span></span>
<span class="line"><span style="color:#A6ACCD;">unqualified-search-registries = </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">docker.io</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">docker.mirrors.ustc.edu.cn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xxxxxx.mirror.aliyuncs.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># \u{1F6AB}\u4E0D\u9700\u8981\u8FD9\u4E48\u590D\u6742\uFF1Blocation\u4E3A\u4E0A\u9762\u963F\u91CC\u4E91\u955C\u50CF\u5730\u5740\uFF0C\u4E0D\u9700\u8981https://</span></span>
<span class="line"><span style="color:#A6ACCD;">unqualified-search-registries = </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">docker.io</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;">registry</span><span style="color:#89DDFF;">]]</span></span>
<span class="line"><span style="color:#A6ACCD;">prefix = </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">docker.io</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">location = </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xxxxxx.mirror.aliyuncs.com</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h2 id="ssh" tabindex="-1">ssh <a class="header-anchor" href="#ssh" aria-hidden="true">#</a></h2><ol><li>\u6DFB\u52A0\u81F3Hosts <code>127.0.0.1:4472 localhost</code></li><li>powershell <code>podman machine ssh sudo ...</code></li></ol><h2 id="rootfull-rootless" tabindex="-1">Rootfull &amp; Rootless <a class="header-anchor" href="#rootfull-rootless" aria-hidden="true">#</a></h2><p>\u{1F389} \u6CE8\u610F\uFF0C\u5207\u6362\u7528\u6237\u4E4B\u540E\u8BB0\u5F97\u91CD\u542F <code>podman machine start</code></p><blockquote><p>Note: Rootfull and Rootless containers are distinct and isolated from one another. Podman commands against one (e.g., podman ps) will not represent results/state for the other.</p></blockquote><h3 id="root" tabindex="-1">root <a class="header-anchor" href="#root" aria-hidden="true">#</a></h3><div class="language-powershell"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u8BBE\u7F6E\u6839\u7528\u6237</span></span>
<span class="line"><span style="color:#A6ACCD;">podman machine stop</span></span>
<span class="line"><span style="color:#A6ACCD;">podman machine set </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">rootful</span></span>
<span class="line"></span></code></pre></div><h3 id="rootless" tabindex="-1">rootless <a class="header-anchor" href="#rootless" aria-hidden="true">#</a></h3><div class="language-powershell"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># To restore rootless execution, set rootful to false:</span></span>
<span class="line"><span style="color:#A6ACCD;">Podman machine stop</span></span>
<span class="line"><span style="color:#A6ACCD;">Podman machine set </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">rootful</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">false</span></span>
<span class="line"></span></code></pre></div><h2 id="cockpit" tabindex="-1">cockpit <a class="header-anchor" href="#cockpit" aria-hidden="true">#</a></h2><p>\u57FA\u4E8E <strong>web</strong> \u7684 <strong>Linux</strong> \u670D\u52A1\u5668\u7BA1\u7406\u5DE5\u5177</p><p><a href="https://cockpit-project.org/running.html#ubuntu" target="_blank" rel="noreferrer">Running Cockpit \u2014 Cockpit Project (cockpit-project.org)</a></p><h3 id="\u5B89\u88C5" tabindex="-1">\u5B89\u88C5 <a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a></h3><p><a href="https://help.ubuntu.com/community/UbuntuBackports#Enabling_Backports" target="_blank" rel="noreferrer">UbuntuBackports - Community Help Wiki</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">apt-get install PACKAGE/RELEASE-backports</span></span>
<span class="line"><span style="color:#A6ACCD;">apt-get install -t RELEASE-backports PACKAGE</span></span>
<span class="line"></span></code></pre></div><blockquote><p>If you are unsure of your release name, you can check it with:</p><p><code>lsb_release -cs</code></p></blockquote><p>\u6216\u8005\u6267\u884C<code>echo \${VERSION_CODENAME}</code>\uFF0C\u6216<code>cat /etc/os-release</code> \u67E5\u770B</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo apt update</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo apt upgrade</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo apt install -t jammy-backports cockpit</span></span>
<span class="line"></span></code></pre></div><h3 id="\u542F\u52A8" tabindex="-1">\u542F\u52A8 <a class="header-anchor" href="#\u542F\u52A8" aria-hidden="true">#</a></h3><blockquote><p>If you already have Cockpit on your server, point your web browser to: <strong>https://<em><strong>ip-address-of-machine</strong></em>:9090</strong></p></blockquote><blockquote><p>If your browser is on the same machine where Cockpit is running, then visit localhost:9090</p></blockquote><p><a href="https://www.how2shout.com/linux/how-to-install-cockpit-on-ubuntu-22-04-20-04-lts/#4_Start_and_Enable_Cockpit_service" target="_blank" rel="noreferrer">How to Install Cockpit on Ubuntu 22.04 | 20.04 LTS - Linux Shout</a></p><blockquote><p>With successful installation, this web-based server management will be on your system. However, we have to start its service manually to access it. Also, at the same time enable it to start automatically in case of crash or system reboot.</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo systemctl start cockpit cockpit.socket</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo systemctl </span><span style="color:#82AAFF;">enable</span><span style="color:#A6ACCD;"> --now cockpit.socket</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo systemctl stop cockpit cockpit.socket</span></span>
<span class="line"></span></code></pre></div><p><s>\u4F1A\u62A5\u9519\uFF1A<strong style="color:red;">System has not been booted with systemd as init system (PID 1). Can&#39;t operate. Failed to connect to bus: Host is down</strong> \uFF0C\u56E0\u4E3AWSL2\u5728\u622A\u81F32022\u5E748\u670831\u65E5\u65F6\u4E0D\u652F\u6301 Systemd</s></p><p><code>wsl.exe --version</code> \u67E5\u770B WSL \u7248\u672C\uFF1A<code>0.67.6.0</code>\u4EE5\u4E0A\u7248\u672C\u7684 WSL2 \u73B0\u5DF2\u652F\u6301 Systemd</p><h2 id="wsl2\u73B0\u5DF2\u652F\u6301systemd-2022-9-27" tabindex="-1">WSL2\u73B0\u5DF2\u652F\u6301Systemd-2022.9.27 <a class="header-anchor" href="#wsl2\u73B0\u5DF2\u652F\u6301systemd-2022-9-27" aria-hidden="true">#</a></h2><blockquote><p><a href="https://www.v2ex.com/t/882117" target="_blank" rel="noreferrer">WSL2 \u73B0\u5DF2\u652F\u6301 Systemd - V2EX</a></p><p><a href="https://devblogs.microsoft.com/commandline/systemd-support-is-now-available-in-wsl/" target="_blank" rel="noreferrer">Systemd support is now available in WSL!</a></p></blockquote><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u8BBE\u7F6E systemd \u5F00\u673A\u81EA\u542F\uFF08\u5728 Linux \u5185\u6267\u884C\u4EE5\u4E0B\u547D\u4EE4\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo vim /etc/wsl.conf</span></span>
<span class="line"><span style="color:#676E95;"># \u8BBE\u7F6E\u4EE5\u4E0B\u5185\u5BB9</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">boot</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">systemd=true</span></span>
<span class="line"><span style="color:#676E95;"># \u9000\u51FA Linux \u5B50\u7CFB\u7EDF\uFF0C\u5E76\u5173\u95ED WSL</span></span>
<span class="line"><span style="color:#A6ACCD;">wsl.exe --shutdown</span></span>
<span class="line"><span style="color:#676E95;"># \u91CD\u65B0\u8FDB\u5165 WSL \uFF0C\u8F93\u5165\u2B07\uFE0F\u2B07\uFE0F\u2B07\uFE0F\uFF0C\u5373\u53EF\u68C0\u9A8C systemd \u7684\u8FD0\u884C\u72B6\u6001</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-unit-files --type=service</span></span>
<span class="line"></span></code></pre></div><h2 id="\u89E3\u51B3wsl2\u4E0D\u652F\u6301systemd\u{1F6AB}" tabindex="-1"><s>\u89E3\u51B3WSL2\u4E0D\u652F\u6301Systemd\u{1F6AB}</s> <a class="header-anchor" href="#\u89E3\u51B3wsl2\u4E0D\u652F\u6301systemd\u{1F6AB}" aria-hidden="true">#</a></h2><p><a href="https://askubuntu.com/questions/1379425/system-has-not-been-booted-with-systemd-as-init-system-pid-1-cant-operate#:~:text=How%20to%20handle%20the%20lack%20of%20Systemd" target="_blank" rel="noreferrer">How to handle the lack of Systemd</a> \uFF0C\u6709\u6570\u79CD\u65B9\u5F0F\u53EF\u4EE5\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u4EE5\u4E0B\u4E3A\u6211\u8BD5\u8FC7\u7684\u4E00\u79CD</p><p><a href="https://github.com/nullpo-head/wsl-distrod#option-2-make-your-current-distro-run-systemd" target="_blank" rel="noreferrer">Make your Current WSL2 Distro Run Systemd</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u5988\u7684\uFF0C\u7FFB\u5899\u4E5F\u8FDE\u4E0D\u4E0A\uFF0C\u76F4\u63A5\u6D4F\u89C8\u5668\u6253\u5F00https://raw.githubusercontent.com...</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -L -O </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://raw.githubusercontent.com/nullpo-head/wsl-distrod/main/install.sh</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#676E95;"># \u6211\u653E\u5230\u4E86 /home/my-config/install.sh</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> /home/myconfig</span></span>
<span class="line"><span style="color:#676E95;"># \u7ED9\u4E88\u6267\u884C\u6743\u9650</span></span>
<span class="line"><span style="color:#A6ACCD;">chmod +x install.sh</span></span>
<span class="line"><span style="color:#676E95;"># This script installs distrod, but doesn&#39;t enable it yet.</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo ./install.sh install</span></span>
<span class="line"></span></code></pre></div><h3 id="enable-distrod-in-your-distro" tabindex="-1">Enable distrod in your distro <a class="header-anchor" href="#enable-distrod-in-your-distro" aria-hidden="true">#</a></h3><blockquote><p>You have two options. If you want to automatically start your distro on Windows startup, enable distrod by the following command</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> /opt/distrod/bin/distrod </span><span style="color:#82AAFF;">enable</span><span style="color:#A6ACCD;"> --start-on-windows-boot</span></span>
<span class="line"></span></code></pre></div><blockquote><p>Otherwise,</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"> /opt/distrod/bin/distrod </span><span style="color:#82AAFF;">enable</span></span>
<span class="line"></span></code></pre></div><blockquote><p>You can run <code>enable</code> with <code>--start-on-windows-boot</code> again if you want to enable autostart later.</p></blockquote><h3 id="disable-systemd-distrod" tabindex="-1">Disable Systemd Distrod <a class="header-anchor" href="#disable-systemd-distrod" aria-hidden="true">#</a></h3><p><a href="https://github.com/nullpo-head/wsl-distrod/blob/main/docs/references.md#disable-systemd--distrod" target="_blank" rel="noreferrer">disable-systemd--distrod</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo /opt/distrod/bin/distrod disable</span></span>
<span class="line"></span></code></pre></div><h3 id="uninstall-distrod" tabindex="-1">Uninstall distrod <a class="header-anchor" href="#uninstall-distrod" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u5728myconfig\u76EE\u5F55\u4E0B\u5378\u8F7D\uFF0C\u770B\u76EE\u5F55 /opt/distrod/</span></span>
<span class="line"><span style="color:#A6ACCD;">chmod +x install.sh</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo ./install.sh uninstall</span></span>
<span class="line"></span></code></pre></div><h3 id="restart-your-distro" tabindex="-1">Restart your distro <a class="header-anchor" href="#restart-your-distro" aria-hidden="true">#</a></h3><blockquote><p>Close your WSL&#39;s terminal. Open a new Command Prompt window, and run the following command.</p></blockquote><div class="language-powershell"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u62A5\u9519\uFF1A\u{1F6AB}\u4E0D\u5B58\u5728\u5177\u6709\u6240\u63D0\u4F9B\u540D\u79F0\u7684\u5206\u53D1</span></span>
<span class="line"><span style="color:#A6ACCD;">wsl </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">terminate Distrod</span></span>
<span class="line"></span></code></pre></div><blockquote><p>After re-opening a new WSL window, your shell runs in a systemd session.</p></blockquote><p>\u6D4B\u8BD5\u5F53\u524Dsystemctl\u662F\u5426\u5728WSL2\u4E0B\u53EF\u7528\uFF0C\u53EF\u4EE5\u5728wsl bash\u4E0B<code>pstree</code>\u6216\u76F4\u63A5<code>systemctl</code></p><h3 id="\u65B0\u5F00wsl-bash\u6267\u884C" tabindex="-1">\u65B0\u5F00wsl bash\u6267\u884C <a class="header-anchor" href="#\u65B0\u5F00wsl-bash\u6267\u884C" aria-hidden="true">#</a></h3><p>\u5E38\u7528\u7684 Bash \u5C31\u662F Shell \u7684\u4E00\u79CD\uFF0C\u4E5F\u662F Linux \u4E0B\u7684\u9ED8\u8BA4 Shell \u7A0B\u5E8F\uFF0C <strong>Zsh</strong> \u4E00\u4E2A\u66F4\u5F3A\u5927\uFF0C\u66F4\u4EBA\u6027\u5316\u7684 Shell</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># \u6267\u884C /opt/distrod/bin/distrod enable \u4E0D\u52A0\u53C2\u6570 --start-on-windows-boot \u65F6\uFF0C\u6BCF\u6B21\u5F00\u673A\u9700\u8981\u518D\u6B21\u6267\u884C</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo systemctl start cockpit cockpit.socket</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo systemctl </span><span style="color:#82AAFF;">enable</span><span style="color:#A6ACCD;"> --now cockpit.socket</span></span>
<span class="line"></span></code></pre></div><p>localhost:9090 \u8D26-\u5BC6(WSL2\u7684\u7528\u6237\u8D26\u5BC6)\uFF1Aroot/klaus - root</p><p><a href="https://www.how2shout.com/linux/how-to-install-cockpit-on-ubuntu-22-04-20-04-lts/#4_Start_and_Enable_Cockpit_service:~:text=9.-,Login%20Cockpit%20web%20management%20interface,-We%20can%20use" target="_blank" rel="noreferrer">Login Cockpit web management interface</a></p><blockquote><p>We can use any user available on your system, however, it must be at least a non-root user with sudo access; so that you can manage various services directly using the Cockpit Interface. Alternatively, you go for the <strong>root</strong> user as well.</p></blockquote><p><img src="https://ulooklikeamovie.oss-cn-beijing.aliyuncs.com/img/image-20220901001341506.png" alt="image-20220901001341506"></p><h2 id="cockpit-extendable" tabindex="-1">cockpit Extendable <a class="header-anchor" href="#cockpit-extendable" aria-hidden="true">#</a></h2><p>Cockpit also supports <a href="https://cockpit-project.org/applications.html" target="_blank" rel="noreferrer">a large list of optional and third-party applications</a>.</p><h3 id="podman-container-support" tabindex="-1">Podman container support <a class="header-anchor" href="#podman-container-support" aria-hidden="true">#</a></h3><p><a href="https://cockpit-project.org/applications.html#:~:text=cockpit%2Dmachines/issues-,Podman%20Containers,-official" target="_blank" rel="noreferrer">Podman Containers</a></p><p><a href="https://www.how2shout.com/linux/how-to-install-cockpit-on-ubuntu-22-04-20-04-lts/#:~:text=6.-,Enable%20Docker/Podman%20container%20support,-If%20you%20already" target="_blank" rel="noreferrer">Enable Podman container support</a></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo apt install cockpit-podman -y</span></span>
<span class="line"></span></code></pre></div>`,115),t=[l];function r(p,c,i,d,h,u){return a(),e("div",null,t)}const b=s(o,[["render",r]]);export{m as __pageData,b as default};
